<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Loch Leven â€“ Hiking Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    html, body, #map { height: 100%; margin: 0; }
    .leaflet-container { font: 14px/1.3 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    .legend {
      position: absolute; bottom: 12px; left: 12px; background: white; padding: 6px 8px;
      border-radius: 6px; box-shadow: 0 1px 6px rgba(0,0,0,.15);
    }
    .legend .swatch { display:inline-block; width:18px; height:3px; background:#e74c3c; margin-right:6px; vertical-align:middle; }
  </style>
</head>
<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  // 1) Base map centered roughly on SF (we'll auto-fit to the trail once it loads)
  const map = L.map('map', { zoomControl: true }).setView([37.7749, -122.4194], 12);

  L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  L.control.scale({ metric: false }).addTo(map);

  // 2) Load your trail GeoJSON (adjust path if it's in /data)
  const TRAIL_GEOJSON_URL = './loch.levens.geojson'; // or './data/loch.levens.geojson'

  fetch(TRAIL_GEOJSON_URL)
    .then(r => {
      if (!r.ok) throw new Error(`HTTP ${r.status} loading ${TRAIL_GEOJSON_URL}`);
      return r.json();
    })
    .then(geo => {
      const trailLayer = L.geoJSON(geo, {
        style: feature => ({ color: '#e74c3c', weight: 3 }),
        onEachFeature: (f, layer) => {
          const name = f?.properties?.name || 'Trail';
          layer.bindPopup(name);
        }
      }).addTo(map);

      // Fit map to the trail geometry
      const b = trailLayer.getBounds();
      if (b.isValid()) map.fitBounds(b, { padding: [20, 20] });

      // Optional: drop a trailhead marker if your GeoJSON has a "trailhead" Point or a property
      // Example (uncomment and adapt):
      // L.marker([39.319, -120.542]).addTo(map).bindPopup('Trailhead');
    })
    .catch(err => {
      console.error(err);
      alert('Could not load the trail GeoJSON. Check the file path and try again.');
    });

  // Optional: simple legend
  const legend = L.control({ position: 'bottomleft' });
  legend.onAdd = () => {
    const div = L.DomUtil.create('div', 'legend');
    div.innerHTML = '<div><span class="swatch"></span>Hiking trail</div>';
    return div;
  };
  legend.addTo(map);
</script>
</body>
</html>
